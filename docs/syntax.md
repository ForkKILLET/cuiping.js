# 「Cuiping 式」语法

「Cuiping 式」精确描述一个「化学结构」

## 原子团

「化学结构」由一个「原子团」开始。「原子团」可以：
- 包含大小写字母，大写字母后的小写字母会与之合并在一个字框内（使元素符号更自然）
- 包含数字，数字会被渲染为下标形式
- 是一个单独的「通配符」 `*`，不渲染（用于表示取代基）
- 是一个单独的「塌缩碳原子」 `.`，不渲染，与之相连的键不会留白（类似键线式）

## 键

「原子团」后可以跟随「键」：
- 跟随多个「键」，称为「键组」，书写在 `[]` 内，用 `,` 隔开
- 跟随单个「键」
- 单个「键」和「键组」可以同时存在，这时单个「键」要写在「键组」的后面

「键」的写法：
- 「键」由「键类型」和其连接的「化学结构」组成，组成方式见下
- 「键类型」描述键的根数和方向，「键根数」在前，「键方向」在后
- 「键类型」的开始可以有「键修饰符」

「键根数」：
- 用 `=` 表示双键，`#` 表示三键 
- 默认为单键

「键方向」和书写结构式的习惯相同：
- 用 `-`、`|`、`/`、`\` 分别表示 0°、90°、60°、270° 的「键」
- 当「键类型」写在连接的「化学结构」前时，方向即如上条所说；写在其后时，则反向（加上 180°）
- 「键类型」写在连接的「化学结构」后时，只能出现在「键组」内

「键修饰符」：
- 为了在「键组」外书写反方向的键，可以使用 `!` 修饰符

## 范式

```
cuiping         = <chem>
chem            = <group> (<bonds>)? (<bond>)?
bonds           = [ <bond> (, <bond>)* ]
bond            = <pre bond> | <post bond>
pre bond        = <bond dir> <cuiping>
post bond       = <cuiping> <bond dir>
bond dir        = (<bond count> <bond dir> | <bond count> | <bond dir>)
                | <bond modifier> ((bond count)? (bond dir)?)
bond count      = '=' | #
bond dir        = (+ | - | / | \ | '|')*
bond modifier   = !
group           = (<letter> | <number> | '(' | ')')+ | '.' | '*'
```